<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Unified EPF & NPS Retirement Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&display=swap" rel="stylesheet" />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      overflow-x: hidden;
      color: #2c2c2c;
    }
    .bg-animated {
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      z-index: 0;
      overflow: hidden;
      pointer-events: none;
    }
    .bubble {
      position: absolute;
      border-radius: 50%;
      opacity: 0.15;
      animation: floatUp 20s linear infinite;
      mix-blend-mode: screen;
      filter: drop-shadow(0 0 4px rgba(255 255 255 / 0.3));
    }
    .bubble1 { width: 220px; height: 220px; background: #ff6b6b; left: 10vw; bottom: -150px; animation-delay: 0s; }
    .bubble2 { width: 150px; height: 150px; background: #fbc531; left: 70vw; bottom: -120px; animation-delay: 6s; }
    .bubble3 { width: 180px; height: 180px; background: #1dd1a1; left: 40vw; bottom: -140px; animation-delay: 3s; }
    .bubble4 { width: 100px; height: 100px; background: #54a0ff; left: 85vw; bottom: -100px; animation-delay: 9s; }
    .bubble5 { width: 130px; height: 130px; background: #ff9f43; left: 25vw; bottom: -110px; animation-delay: 12s; }
    @keyframes floatUp {
      0% { transform: translateY(0) scale(1); opacity: 0.15;}
      50% { opacity: 0.25;}
      100% { transform: translateY(-110vh) scale(1.1); opacity: 0;}
    }
    .container {
      position: relative;
      z-index: 10;
      max-width: 1100px;
      margin: 40px auto 60px;
      background: rgba(255 255 255 / 0.12);
      border-radius: 24px;
      padding: 36px 40px 40px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(18px);
      border: 1px solid rgba(255 255 255 / 0.18);
    }
    h1 {
      font-weight: 700;
      font-size: 2.6rem;
      color: #fff;
      text-align: center;
      margin-bottom: 6px;
      letter-spacing: 1.2px;
      text-shadow: 0 0 8px rgba(255 255 255 / 0.7);
    }
    .subtitle {
      text-align: center;
      font-size: 1.1rem;
      color: #d1d1d1;
      margin-bottom: 36px;
      text-shadow: 0 0 6px rgba(255 255 255 / 0.4);
    }
    .plan-toggle {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-bottom: 32px;
    }
    .toggle-btn {
      background: rgba(255 255 255 / 0.2);
      border: none;
      border-radius: 30px;
      padding: 12px 36px;
      font-size: 1.15rem;
      color: #eee;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 0 12px rgba(0 0 0 / 0.15);
      transition: background 0.3s, color 0.3s, box-shadow 0.3s;
      user-select: none;
    }
    .toggle-btn.selected {
      background: #fff;
      color: #3949ab;
      box-shadow: 0 0 20px #3949abaa;
    }
    .toggle-btn:focus { outline: 2px solid #3949ab; }
    .flex-row {
      display: flex;
      gap: 32px;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .card {
      background: rgba(255 255 255 / 0.25);
      border-radius: 20px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
      padding: 28px 24px 24px;
      flex: 1 1 48%;
      min-width: 320px;
      transition: box-shadow 0.3s ease;
    }
    .card h2 {
      font-weight: 700;
      font-size: 1.5rem;
      color: #3949ab;
      margin-top: 0;
      margin-bottom: 24px;
      text-shadow: 0 0 6px rgba(57,73,171,0.7);
    }
    .form-group { margin-bottom: 18px; }
    label {
      display: block;
      margin-bottom: 6px;
      color: #222;
      font-weight: 600;
      text-shadow: 0 0 3px rgba(255 255 255 / 0.9);
    }
    input[type="number"], input[type="date"], select {
      width: 100%;
      padding: 10px 14px;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      background: rgba(255 255 255 / 0.8);
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.12);
      color: #222;
      font-weight: 600;
    }
    input[type="number"]:focus, input[type="date"]:focus, select:focus {
      box-shadow: inset 0 2px 8px #3949abaa;
      outline: none;
      background: #fff;
    }
    .desc {
      font-size: 0.85rem;
      color: #444;
      margin-top: 4px;
      font-weight: 500;
      font-style: italic;
      user-select: none;
    }
    button[type="submit"] {
      width: 100%;
      background: linear-gradient(90deg, #3949ab 0%, #1976d2 100%);
      color: #fff;
      border: none;
      border-radius: 30px;
      padding: 16px 0;
      font-size: 1.25rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 24px;
      box-shadow: 0 6px 20px #1976d2aa;
      transition: background 0.3s ease, box-shadow 0.3s ease;
      user-select: none;
    }
    button[type="submit"]:hover {
      background: linear-gradient(90deg, #1976d2 0%, #3949ab 100%);
      box-shadow: 0 8px 28px #3949abaa;
    }
    .output {
      margin-top: 36px;
      background: rgba(255 255 255 / 0.9);
      border-radius: 20px;
      padding: 28px 24px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      color: #222;
    }
    .output h2 {
      margin-top: 0;
      font-size: 1.6rem;
      color: #2e7d32;
      text-shadow: 0 0 8px rgba(46,125,50,0.7);
      margin-bottom: 20px;
      font-weight: 700;
    }
    .consolidated-table {
      margin-top: 28px;
      width: 100%;
      border-collapse: collapse;
      font-size: 1.1rem;
      text-align: center;
    }
    .consolidated-table th, .consolidated-table td {
      padding: 12px 16px;
      border-bottom: 1px solid #ccc;
    }
    .consolidated-table th {
      background: #c5cae9;
      color: #283593;
      font-weight: 700;
    }
    .consolidated-table td.status-yes { color: #388e3c; font-weight: 700; }
    .consolidated-table td.status-no { color: #e53935; font-weight: 700; }
    .error-msg {
      color: #e53935;
      background: #fff3f3;
      border: 1px solid #e53935;
      border-radius: 8px;
      padding: 14px 18px;
      margin: 18px 0 0 0;
      font-size: 1.1em;
      font-weight: 700;
      text-align: center;
    }
    .education-section {
      margin-top: 48px;
      background: rgba(255 255 255 / 0.85);
      border-radius: 16px;
      padding: 22px 28px;
      color: #444;
      font-size: 1rem;
      border: 1px solid #b0bec5;
      line-height: 1.5;
      box-shadow: 0 4px 18px rgba(0,0,0,0.1);
    }
    .education-section summary {
      font-weight: 700;
      font-size: 1.15rem;
      cursor: pointer;
      margin-bottom: 12px;
      color: #3949ab;
    }
    @media (max-width: 1100px) {
      .flex-row { flex-direction: column; gap: 24px; }
      .card { max-width: 100%; }
    }
    @media (max-width: 480px) {
      h1 { font-size: 1.8rem; }
      button[type="submit"] { font-size: 1.1rem; padding: 14px 0; }
    }
  </style>
</head>
<body>
  <div class="bg-animated">
    <div class="bubble bubble1"></div>
    <div class="bubble bubble2"></div>
    <div class="bubble bubble3"></div>
    <div class="bubble bubble4"></div>
    <div class="bubble bubble5"></div>
  </div>
  <div class="container">
    <h1>Unified EPF & NPS Retirement Calculator</h1>
    <div class="subtitle">
      Select your retirement streams, fill in your details, and get a consolidated side-by-side view of your retirement projections.
    </div>
    <div class="plan-toggle" role="group" aria-label="Select retirement streams">
      <button type="button" id="epfToggle" class="toggle-btn selected" aria-pressed="true" onclick="selectPlan('epf')">EPF</button>
      <button type="button" id="npsToggle" class="toggle-btn selected" aria-pressed="true" onclick="selectPlan('nps')">NPS</button>
    </div>
    <form id="mainForm" autocomplete="off" aria-live="polite">
      <div class="flex-row">
        <div style="flex:1 1 300px;min-width:260px;max-width:350px;">
          <div class="form-group">
            <label for="currentAge">Current Age</label>
            <input type="number" id="currentAge" value="35" min="18" max="80" required aria-describedby="descCurrentAge" />
            <div id="descCurrentAge" class="desc">Your present age in years.</div>
          </div>
          <div class="form-group">
            <label for="retirementAge">Retirement Age</label>
            <input type="number" id="retirementAge" value="60" min="18" max="80" required aria-describedby="descRetirementAge" />
            <div id="descRetirementAge" class="desc">The age at which you plan to retire.</div>
          </div>
          <div class="form-group">
            <label for="inflationRate">Inflation Rate (%)</label>
            <input type="number" id="inflationRate" value="4" min="0" max="100" step="any" required aria-describedby="descInflationRate" />
            <div id="descInflationRate" class="desc">Annual inflation rate for projections (e.g., 4%).</div>
          </div>
        </div>
        <div style="flex:1 1 300px;min-width:260px;max-width:350px;">
          <div class="form-group">
            <label for="monthlyExpense">Current Monthly Expense (₹)</label>
            <input type="number" id="monthlyExpense" value="50000" min="0" step="any" required aria-describedby="descMonthlyExpense" />
            <div id="descMonthlyExpense" class="desc">Your current monthly living expenses.</div>
          </div>
          <div class="form-group">
            <label for="targetPercent">Target % of Expense (for each stream)</label>
            <input type="number" id="targetPercent" value="30" min="0" max="100" step="any" required aria-describedby="descTargetPercent" />
            <div id="descTargetPercent" class="desc">Percent of retirement expense you want each stream to cover.</div>
          </div>
        </div>
      </div>
      <div class="flex-row" id="plansRow">
        <!-- EPF Fields -->
        <div id="epfFields" class="card" role="region" aria-label="EPF retirement details">
          <h2>EPF Details</h2>
          <div class="form-group">
            <label for="currentEPFBalance">Current EPF Balance (₹)</label>
            <input type="number" id="currentEPFBalance" value="200000" min="0" step="any" aria-describedby="descCurrentEPFBalance" />
            <div id="descCurrentEPFBalance" class="desc">Total amount in your EPF account as of today (including all previous jobs, if transferred).</div>
          </div>
          <div class="form-group">
            <label for="employeeContribution">Employee’s Monthly Contribution (₹)</label>
            <input type="number" id="employeeContribution" value="3600" min="0" step="any" aria-describedby="descEmployeeContribution" />
            <div id="descEmployeeContribution" class="desc">Your current monthly EPF contribution (as per your latest payslip). Enter zero if currently on a break.</div>
          </div>
          <div class="form-group">
            <label for="employerContribution">Employer’s Monthly Contribution (₹)</label>
            <input type="number" id="employerContribution" value="1100" min="0" step="any" aria-describedby="descEmployerContribution" />
            <div id="descEmployerContribution" class="desc">Your employer’s current monthly EPF contribution (as per your latest payslip). Enter zero if currently on a break.</div>
          </div>
          <div class="form-group">
            <label for="salaryGrowth">Expected Annual Salary Growth Rate (%)</label>
            <input type="number" id="salaryGrowth" value="8" min="0" max="100" step="any" aria-describedby="descSalaryGrowth" />
            <div id="descSalaryGrowth" class="desc">Average percentage increase in your basic salary + DA per year (e.g., 8%).</div>
          </div>
          <div class="form-group">
            <label for="epfInterest">EPF Interest Rate (%)</label>
            <input type="number" id="epfInterest" value="8.25" min="0" max="100" step="any" aria-describedby="descEPFInterest" />
            <div id="descEPFInterest" class="desc">
              The EPF interest rate for FY 2024-25 is 8.25%. The 5-year average is about 8.25%.<br />
              (Set by EPFO and reviewed annually.)
            </div>
          </div>
        </div>
        <!-- NPS Fields -->
        <div id="npsFields" class="card" role="region" aria-label="NPS retirement details">
          <h2>NPS Details</h2>
          <div class="form-group">
            <label for="currentNPSBalance">Current NPS Balance (₹)</label>
            <input type="number" id="currentNPSBalance" value="900000" min="0" step="any" aria-describedby="descCurrentNPSBalance" />
            <div id="descCurrentNPSBalance" class="desc">Total amount in your NPS account now.</div>
          </div>
          <div class="form-group">
            <label for="monthlyContributionNPS">Monthly NPS Contribution (₹)</label>
            <input type="number" id="monthlyContributionNPS" value="22000" min="0" step="any" aria-describedby="descMonthlyContributionNPS" />
            <div id="descMonthlyContributionNPS" class="desc">Your monthly NPS contribution.</div>
          </div>
          <div class="form-group">
            <label for="equityReturnNPS">Equity Return (%)</label>
            <input type="number" id="equityReturnNPS" value="12" min="0" max="100" step="any" aria-describedby="descEquityReturnNPS" />
            <div id="descEquityReturnNPS" class="desc">Scheme E (Equity): 5-year average annual return is 11–14%.</div>
          </div>
          <div class="form-group">
            <label for="corporateBondReturnNPS">Corporate Bond Return (%)</label>
            <input type="number" id="corporateBondReturnNPS" value="8" min="0" max="100" step="any" aria-describedby="descCorporateBondReturnNPS" />
            <div id="descCorporateBondReturnNPS" class="desc">Scheme C (Corporate Bonds): 5-year average annual return is 7–9%.</div>
          </div>
          <div class="form-group">
            <label for="governmentBondReturnNPS">Government Bond Return (%)</label>
            <input type="number" id="governmentBondReturnNPS" value="7" min="0" max="100" step="any" aria-describedby="descGovernmentBondReturnNPS" />
            <div id="descGovernmentBondReturnNPS" class="desc">Scheme G (Government Securities): 5-year average annual return is 6–7.5%.</div>
          </div>
          <div class="form-group">
            <label for="equityAllocationNPS">Equity Allocation (%)</label>
            <input type="number" id="equityAllocationNPS" value="75" min="0" max="100" step="any" aria-describedby="descEquityAllocationNPS" />
            <div id="descEquityAllocationNPS" class="desc">Percent of NPS in equity (Scheme E).</div>
          </div>
          <div class="form-group">
            <label for="corporateAllocationNPS">Corporate Allocation (%)</label>
            <input type="number" id="corporateAllocationNPS" value="20" min="0" max="100" step="any" aria-describedby="descCorporateAllocationNPS" />
            <div id="descCorporateAllocationNPS" class="desc">Percent of NPS in corporate bonds (Scheme C).</div>
          </div>
          <div class="form-group">
            <label for="governmentAllocationNPS">Government Allocation (%)</label>
            <input type="number" id="governmentAllocationNPS" value="5" min="0" max="100" step="any" aria-describedby="descGovernmentAllocationNPS" />
            <div id="descGovernmentAllocationNPS" class="desc">Percent of NPS in government securities (Scheme G).</div>
          </div>
          <div class="form-group">
            <label for="swpWithdrawalRateNPS">SWP Withdrawal Rate (%)</label>
            <input type="number" id="swpWithdrawalRateNPS" value="4" min="0" max="100" step="any" aria-describedby="descSWPWithdrawalRateNPS" />
            <div id="descSWPWithdrawalRateNPS" class="desc">Annual withdrawal rate from SWP corpus.</div>
          </div>
          <div class="form-group">
            <label for="annuityReturnNPS">Annuity Return (%)</label>
            <input type="number" id="annuityReturnNPS" value="6" min="0" max="100" step="any" aria-describedby="descAnnuityReturnNPS" />
            <div id="descAnnuityReturnNPS" class="desc">Current annuity rates in India are 5–6.5%.</div>
          </div>
        </div>
      </div>
      <button type="submit" aria-label="Calculate retirement projections">Calculate</button>
    </form>
    <div class="output" id="output" aria-live="polite" aria-atomic="true"></div>
    <div class="education-section">
      <details>
        <summary>ℹ️ About EPF, EPS & NPS (Click to expand)</summary>
        <ul>
          <li><b>EPF:</b> Employee Provident Fund is a mandatory retirement savings scheme for most salaried employees in India. Contributions earn annual interest set by EPFO.</li>
          <li><b>NPS:</b> National Pension System is a voluntary retirement savings scheme with flexible asset allocation and market-linked returns.</li>
          <li><b>Inflation:</b> All projections are inflation-adjusted for realistic retirement planning.</li>
          <li><b>Target % of Expense:</b> Decide what portion of your retirement expense should be covered by each stream.</li>
          <li><b>Safe Withdrawal Rate:</b> EPF monthly income is estimated using a 4% annual withdrawal rate, a common rule of thumb for sustainable withdrawals.</li>
        </ul>
      </details>
    </div>
  </div>
  <script>
    // Toggle plans selection & fields
    function selectPlan(plan) {
      const epfBtn = document.getElementById('epfToggle');
      const npsBtn = document.getElementById('npsToggle');
      const epfFields = document.getElementById('epfFields');
      const npsFields = document.getElementById('npsFields');

      if (plan === 'epf') {
        epfBtn.classList.toggle('selected');
        epfBtn.setAttribute('aria-pressed', epfBtn.classList.contains('selected'));
      } else if (plan === 'nps') {
        npsBtn.classList.toggle('selected');
        npsBtn.setAttribute('aria-pressed', npsBtn.classList.contains('selected'));
      }

      epfFields.style.display = epfBtn.classList.contains('selected') ? '' : 'none';
      npsFields.style.display = npsBtn.classList.contains('selected') ? '' : 'none';
    }
    window.onload = function () {
      selectPlan('epf');
      selectPlan('nps');
    };

    function toCurrency(n) {
      return "₹ " + n.toLocaleString('en-IN', { maximumFractionDigits: 0 });
    }

    document.getElementById('mainForm').addEventListener('submit', function (e) {
      e.preventDefault();

      // Common Inputs
      const currentAge = Number(document.getElementById('currentAge').value);
      const retirementAge = Number(document.getElementById('retirementAge').value);
      const inflationRate = Number(document.getElementById('inflationRate').value) / 100;
      const monthlyExpense = Number(document.getElementById('monthlyExpense').value);
      const targetPercent = Number(document.getElementById('targetPercent').value) / 100;
      const yearsToRetirement = retirementAge - currentAge;
      const showEPF = document.getElementById('epfToggle').classList.contains('selected');
      const showNPS = document.getElementById('npsToggle').classList.contains('selected');

      // Error if neither plan is selected
      if (!showEPF && !showNPS) {
        document.getElementById('output').innerHTML =
          "<div class='error-msg'>Please select at least one retirement stream (EPF or NPS) above.</div>";
        return;
      }

      let epfResults = null, npsResults = null;

      // EPF Calculation
      if (showEPF) {
        const currentEPFBalance = Number(document.getElementById('currentEPFBalance').value) || 0;
        let employeeContribution = Number(document.getElementById('employeeContribution').value) || 0;
        let employerContribution = Number(document.getElementById('employerContribution').value) || 0;
        const salaryGrowth = Number(document.getElementById('salaryGrowth').value) / 100 || 0;
        const epfInterest = Number(document.getElementById('epfInterest').value) / 100 || 0;
        let epfBalance = currentEPFBalance;
        let employeeContrib = employeeContribution, employerContrib = employerContribution;
        for (let year = 1; year <= yearsToRetirement; year++) {
          let yearlyEmployee = employeeContrib * 12;
          let yearlyEmployer = employerContrib * 12;
          let yearlyTotal = yearlyEmployee + yearlyEmployer;
          let yearlyInterest = (epfBalance + yearlyTotal / 2) * epfInterest;
          epfBalance += yearlyEmployee + yearlyEmployer + yearlyInterest;
          employeeContrib *= (1 + salaryGrowth);
          employerContrib *= (1 + salaryGrowth);
        }
        const inflationAdjustedCorpus = epfBalance / Math.pow(1 + inflationRate, yearsToRetirement);
